<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Million-Pixel-Shop</title>
    <style>
        body { text-align: center; font-family: Arial, sans-serif; }
        canvas { border: 1px solid black; cursor: pointer; }
        #colorPicker { margin-top: 10px; display: none; }
    </style>
</head>
<body>
    <h1>Kaufe und gestalte deinen Pixel!</h1>
    <p>Klicke auf einen Pixel, um ihn zu kaufen und färbe ihn danach ein.</p>
    <canvas id="pixelCanvas" width="1000" height="1000"></canvas>
    <input type="color" id="colorPicker" value="#ff0000">

    <script>
        const canvas = document.getElementById('pixelCanvas');
        const ctx = canvas.getContext('2d');
        const colorPicker = document.getElementById('colorPicker');

        const pixelSize = 1; // 1 Pixel = 1x1 px
        const rows = 1000;
        const cols = 1000;
        let boughtPixels = {}; // Speichert gekaufte Pixel mit ihrer Farbe

        // Initiales Raster zeichnen
        function drawPixels() {
            ctx.fillStyle = 'lightgray';
            ctx.fillRect(0, 0, cols, rows);
        }

        drawPixels(); // Starte mit leerem Raster

        let selectedPixel = null; // Speichert den zuletzt geklickten Pixel

        // Pixel-Klick-Event
        canvas.addEventListener('click', function(event) {
            const rect = canvas.getBoundingClientRect();
            const x = Math.floor(event.clientX - rect.left);
            const y = Math.floor(event.clientY - rect.top);
            const pixelKey = `${x},${y}`;

            if (boughtPixels[pixelKey]) {
                // Wenn Pixel gekauft wurde -> Farbe ändern
                selectedPixel = pixelKey;
                colorPicker.style.display = 'block';
                colorPicker.value = boughtPixels[pixelKey]; // Setze aktuelle Farbe
            } else {
                // Pixel kaufen
                const confirmation = confirm(`Willst du den Pixel bei (${x}, ${y}) kaufen?`);
                if (confirmation) {
                    boughtPixels[pixelKey] = '#ff0000'; // Standardfarbe nach Kauf
                    ctx.fillStyle = boughtPixels[pixelKey];
                    ctx.fillRect(x, y, pixelSize, pixelSize);
                }
            }
        });

        // Farbe nach Kauf ändern
        colorPicker.addEventListener('input', function() {
            if (selectedPixel) {
                const [x, y] = selectedPixel.split(',').map(Number);
                boughtPixels[selectedPixel] = colorPicker.value;
                ctx.fillStyle = colorPicker.value;
                ctx.fillRect(x, y, pixelSize, pixelSize);
            }
        });
    </script>
</body>
</html>
